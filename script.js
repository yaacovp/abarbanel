        // Complete data structure with all Sefarim, Parachiyot and Jewish holidays
        const audioData = {
            berechit: {
                name: "Beréchit",
                nameEn: "Genesis",
                nameHe: "בראשית",
                parachiot: {
                    berechit: {
                        name: "Beréchit",
                        nameEn: "Bereshit",
                        nameHe: "בראשית",
                        audios: [
                            {
                                title: "La création du monde - Partie 1",
                                titleEn: "The Creation of the World - Part 1",
                                titleHe: "בריאת העולם - חלק א",
                                description: "Enseignement sur les premiers versets de la Torah",
                                descriptionEn: "Teaching on the first verses of the Torah",
                                descriptionHe: "הוראה על הפסוקים הראשונים של התורה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-01-15"
                            },
                            {
                                title: "La création du monde - Partie 2",
                                titleEn: "The Creation of the World - Part 2",
                                titleHe: "בריאת העולם - חלק ב",
                                description: "Suite de l'enseignement sur la création",
                                descriptionEn: "Continuation of the teaching on creation",
                                descriptionHe: "המשך ההוראה על הבריאה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-01-16"
                            }
                        ]
                    },
                    noah: {
                        name: "Noah",
                        nameEn: "Noah",
                        nameHe: "נח",
                        audios: [
                            {
                                title: "L'arche de Noé",
                                titleEn: "Noah's Ark",
                                titleHe: "תיבת נח",
                                description: "Enseignement sur l'histoire de Noé et le déluge",
                                descriptionEn: "Teaching on Noah's story and the flood",
                                descriptionHe: "הוראה על סיפור נח והמבול",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-01-20"
                            }
                        ]
                    },
                    lech_lecha: {
                        name: "Lech Lecha",
                        nameEn: "Lech Lecha",
                        nameHe: "לך לך",
                        audios: [
                            {
                                title: "L'appel d'Abraham",
                                titleEn: "Abraham's Call",
                                titleHe: "קריאת אברהם",
                                description: "Le voyage spirituel d'Abraham",
                                descriptionEn: "Abraham's spiritual journey",
                                descriptionHe: "המסע הרוחני של אברהם",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-01-25"
                            }
                        ]
                    },
                    vayera: {
                        name: "Vayera",
                        nameEn: "Vayera",
                        nameHe: "וירא",
                        audios: [
                            {
                                title: "L'hospitalité d'Abraham",
                                titleEn: "Abraham's Hospitality",
                                titleHe: "הכנסת אורחים של אברהם",
                                description: "Les trois anges et l'hospitalité",
                                descriptionEn: "The three angels and hospitality",
                                descriptionHe: "שלושת המלאכים והכנסת אורחים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-02-01"
                            }
                        ]
                    },
                    chayei_sarah: {
                        name: "Chayei Sarah",
                        nameEn: "Chayei Sarah",
                        nameHe: "חיי שרה",
                        audios: [
                            {
                                title: "La vie de Sarah",
                                titleEn: "The Life of Sarah",
                                titleHe: "חיי שרה",
                                description: "Enseignement sur la vie et la mort de Sarah",
                                descriptionEn: "Teaching on Sarah's life and death",
                                descriptionHe: "הוראה על חייה ומותה של שרה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-02-05"
                            }
                        ]
                    },
                    toldot: {
                        name: "Toldot",
                        nameEn: "Toldot",
                        nameHe: "תולדות",
                        audios: [
                            {
                                title: "Jacob et Ésaü",
                                titleEn: "Jacob and Esau",
                                titleHe: "יעקב ועשו",
                                description: "L'histoire des jumeaux rivaux",
                                descriptionEn: "The story of the rival twins",
                                descriptionHe: "סיפור התאומים המתחרים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-02-10"
                            }
                        ]
                    },
                    vayetze: {
                        name: "Vayetze",
                        nameEn: "Vayetze",
                        nameHe: "ויצא",
                        audios: [
                            {
                                title: "L'échelle de Jacob",
                                titleEn: "Jacob's Ladder",
                                titleHe: "סולם יעקב",
                                description: "Le rêve de Jacob et sa signification",
                                descriptionEn: "Jacob's dream and its meaning",
                                descriptionHe: "חלום יעקב ומשמעותו",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-02-15"
                            }
                        ]
                    },
                    vayishlach: {
                        name: "Vayishlach",
                        nameEn: "Vayishlach",
                        nameHe: "וישלח",
                        audios: [
                            {
                                title: "La lutte de Jacob",
                                titleEn: "Jacob's Struggle",
                                titleHe: "מאבק יעקב",
                                description: "Jacob lutte avec l'ange",
                                descriptionEn: "Jacob wrestles with the angel",
                                descriptionHe: "יעקב נאבק עם המלאך",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-02-20"
                            }
                        ]
                    },
                    vayeshev: {
                        name: "Vayeshev",
                        nameEn: "Vayeshev",
                        nameHe: "וישב",
                        audios: [
                            {
                                title: "Joseph et ses frères",
                                titleEn: "Joseph and his Brothers",
                                titleHe: "יוסף ואחיו",
                                description: "L'histoire de Joseph et la tunique multicolore",
                                descriptionEn: "The story of Joseph and the colorful coat",
                                descriptionHe: "סיפור יוסף והכתונת הצבעונית",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-02-25"
                            }
                        ]
                    },
                    miketz: {
                        name: "Miketz",
                        nameEn: "Miketz",
                        nameHe: "מקץ",
                        audios: [
                            {
                                title: "Les rêves de Pharaon",
                                titleEn: "Pharaoh's Dreams",
                                titleHe: "חלומות פרעה",
                                description: "Joseph interprète les rêves",
                                descriptionEn: "Joseph interprets the dreams",
                                descriptionHe: "יוסף פותר את החלומות",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-01"
                            }
                        ]
                    },
                    vayigash: {
                        name: "Vayigash",
                        nameEn: "Vayigash",
                        nameHe: "ויגש",
                        audios: [
                            {
                                title: "La révélation de Joseph",
                                titleEn: "Joseph's Revelation",
                                titleHe: "התגלות יוסף",
                                description: "Joseph se révèle à ses frères",
                                descriptionEn: "Joseph reveals himself to his brothers",
                                descriptionHe: "יוסף מתגלה לאחיו",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-05"
                            }
                        ]
                    },
                    vayechi: {
                        name: "Vayechi",
                        nameEn: "Vayechi",
                        nameHe: "ויחי",
                        audios: [
                            {
                                title: "Les bénédictions de Jacob",
                                titleEn: "Jacob's Blessings",
                                titleHe: "ברכות יעקב",
                                description: "Jacob bénit ses fils avant sa mort",
                                descriptionEn: "Jacob blesses his sons before his death",
                                descriptionHe: "יעקב מברך את בניו לפני מותו",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-10"
                            }
                        ]
                    }
                }
            },
            chemot: {
                name: "Chemot",
                nameEn: "Exodus",
                nameHe: "שמות",
                parachiot: {
                    chemot: {
                        name: "Chemot",
                        nameEn: "Shemot",
                        nameHe: "שמות",
                        audios: [
                            {
                                title: "L'oppression en Égypte",
                                titleEn: "The Oppression in Egypt",
                                titleHe: "השעבוד במצרים",
                                description: "Le début de l'esclavage des Hébreux",
                                descriptionEn: "The beginning of Hebrew slavery",
                                descriptionHe: "תחילת שעבוד העברים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-15"
                            }
                        ]
                    },
                    vaera: {
                        name: "Vaera",
                        nameEn: "Vaera",
                        nameHe: "וארא",
                        audios: [
                            {
                                title: "Les dix plaies - Partie 1",
                                titleEn: "The Ten Plagues - Part 1",
                                titleHe: "עשר המכות - חלק א",
                                description: "Les premières plaies d'Égypte",
                                descriptionEn: "The first plagues of Egypt",
                                descriptionHe: "המכות הראשונות של מצרים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-20"
                            }
                        ]
                    },
                    bo: {
                        name: "Bo",
                        nameEn: "Bo",
                        nameHe: "בא",
                        audios: [
                            {
                                title: "La dernière plaie",
                                titleEn: "The Last Plague",
                                titleHe: "המכה האחרונה",
                                description: "La mort des premiers-nés",
                                descriptionEn: "The death of the firstborn",
                                descriptionHe: "מות הבכורות",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-25"
                            }
                        ]
                    },
                    beshalach: {
                        name: "Beshalach",
                        nameEn: "Beshalach",
                        nameHe: "בשלח",
                        audios: [
                            {
                                title: "La traversée de la mer Rouge",
                                titleEn: "Crossing the Red Sea",
                                titleHe: "קריעת ים סוף",
                                description: "Le miracle de la mer Rouge",
                                descriptionEn: "The miracle of the Red Sea",
                                descriptionHe: "נס ים סוף",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-30"
                            }
                        ]
                    },
                    yitro: {
                        name: "Yitro",
                        nameEn: "Yitro",
                        nameHe: "יתרו",
                        audios: [
                            {
                                title: "Les Dix Commandements",
                                titleEn: "The Ten Commandments",
                                titleHe: "עשרת הדברות",
                                description: "La révélation au mont Sinaï",
                                descriptionEn: "The revelation at Mount Sinai",
                                descriptionHe: "ההתגלות בהר סיני",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-05"
                            }
                        ]
                    },
                    mishpatim: {
                        name: "Mishpatim",
                        nameEn: "Mishpatim",
                        nameHe: "משפטים",
                        audios: [
                            {
                                title: "Les lois civiles",
                                titleEn: "Civil Laws",
                                titleHe: "החוקים האזרחיים",
                                description: "Les premières lois de la Torah",
                                descriptionEn: "The first laws of the Torah",
                                descriptionHe: "החוקים הראשונים של התורה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-10"
                            }
                        ]
                    },
                    terumah: {
                        name: "Terumah",
                        nameEn: "Terumah",
                        nameHe: "תרומה",
                        audios: [
                            {
                                title: "La construction du Tabernacle",
                                titleEn: "Building the Tabernacle",
                                titleHe: "בניית המשכן",
                                description: "Les plans divins pour le Mishkan",
                                descriptionEn: "Divine plans for the Mishkan",
                                descriptionHe: "התכניות האלוהיות למשכן",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-15"
                            }
                        ]
                    },
                    tetzaveh: {
                        name: "Tetzaveh",
                        nameEn: "Tetzaveh",
                        nameHe: "תצוה",
                        audios: [
                            {
                                title: "Les vêtements sacerdotaux",
                                titleEn: "Priestly Garments",
                                titleHe: "בגדי הכהונה",
                                description: "Les habits d'Aaron et de ses fils",
                                descriptionEn: "The garments of Aaron and his sons",
                                descriptionHe: "בגדי אהרן ובניו",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-20"
                            }
                        ]
                    },
                    ki_tisa: {
                        name: "Ki Tisa",
                        nameEn: "Ki Tisa",
                        nameHe: "כי תשא",
                        audios: [
                            {
                                title: "Le veau d'or",
                                titleEn: "The Golden Calf",
                                titleHe: "עגל הזהב",
                                description: "La faute du peuple et le pardon divin",
                                descriptionEn: "The people's sin and divine forgiveness",
                                descriptionHe: "חטא העם והסליחה האלוהית",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-25"
                            }
                        ]
                    },
                    vayakhel: {
                        name: "Vayakhel",
                        nameEn: "Vayakhel",
                        nameHe: "ויקהל",
                        audios: [
                            {
                                title: "L'assemblée du peuple",
                                titleEn: "Gathering the People",
                                titleHe: "קיבוץ העם",
                                description: "Moïse rassemble le peuple pour construire",
                                descriptionEn: "Moses gathers the people to build",
                                descriptionHe: "משה אוסף את העם לבנות",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-30"
                            }
                        ]
                    },
                    pekudei: {
                        name: "Pekudei",
                        nameEn: "Pekudei",
                        nameHe: "פקודי",
                        audios: [
                            {
                                title: "L'achèvement du Tabernacle",
                                titleEn: "Completion of the Tabernacle",
                                titleHe: "השלמת המשכן",
                                description: "La gloire divine remplit le Mishkan",
                                descriptionEn: "Divine glory fills the Mishkan",
                                descriptionHe: "כבוד השם ממלא את המשכן",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-05-05"
                            }
                        ]
                    }
                }
            },
            vayikra: {
                name: "Vayikra",
                nameEn: "Leviticus",
                nameHe: "ויקרא",
                parachiot: {
                    vayikra: {
                        name: "Vayikra",
                        nameEn: "Vayikra",
                        nameHe: "ויקרא",
                        audios: [
                            {
                                title: "Les sacrifices",
                                titleEn: "The Sacrifices",
                                titleHe: "הקרבנות",
                                description: "Introduction aux lois des sacrifices",
                                descriptionEn: "Introduction to the laws of sacrifices",
                                descriptionHe: "מבוא לחוקי הקרבנות",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-05-10"
                            }
                        ]
                    },
                    tzav: {
                        name: "Tzav",
                        nameEn: "Tzav",
                        nameHe: "צו",
                        audios: [
                            {
                                title: "Les commandements aux prêtres",
                                titleEn: "Commands to the Priests",
                                titleHe: "הציוויים לכהנים",
                                description: "Instructions détaillées pour les Cohanim",
                                descriptionEn: "Detailed instructions for the Cohanim",
                                descriptionHe: "הוראות מפורטות לכהנים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-05-15"
                            }
                        ]
                    },
                    shemini: {
                        name: "Shemini",
                        nameEn: "Shemini",
                        nameHe: "שמיני",
                        audios: [
                            {
                                title: "Le huitième jour",
                                titleEn: "The Eighth Day",
                                titleHe: "היום השמיני",
                                description: "L'inauguration du service du Temple",
                                descriptionEn: "Inauguration of the Temple service",
                                descriptionHe: "חנוכת עבודת המקדש",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-05-20"
                            }
                        ]
                    },
                    tazria: {
                        name: "Tazria",
                        nameEn: "Tazria",
                        nameHe: "תזריע",
                        audios: [
                            {
                                title: "Les lois de pureté",
                                titleEn: "Laws of Purity",
                                titleHe: "חוקי הטהרה",
                                description: "Enseignements sur la pureté rituelle",
                                descriptionEn: "Teachings on ritual purity",
                                descriptionHe: "הוראות על טהרה פולחנית",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-05-25"
                            }
                        ]
                    },
                    metzora: {
                        name: "Metzora",
                        nameEn: "Metzora",
                        nameHe: "מצורע",
                        audios: [
                            {
                                title: "La purification du lépreux",
                                titleEn: "Purification of the Leper",
                                titleHe: "טהרת המצורע",
                                description: "Le processus de purification spirituelle",
                                descriptionEn: "The process of spiritual purification",
                                descriptionHe: "תהליך הטיהור הרוחני",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-05-30"
                            }
                        ]
                    },
                    acharei_mot: {
                        name: "Acharei Mot",
                        nameEn: "Acharei Mot",
                        nameHe: "אחרי מות",
                        audios: [
                            {
                                title: "Après la mort",
                                titleEn: "After Death",
                                titleHe: "אחרי מות",
                                description: "Le service de Yom Kippour",
                                descriptionEn: "The Yom Kippur service",
                                descriptionHe: "עבודת יום הכיפורים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-06-05"
                            }
                        ]
                    },
                    kedoshim: {
                        name: "Kedoshim",
                        nameEn: "Kedoshim",
                        nameHe: "קדושים",
                        audios: [
                            {
                                title: "Soyez saints",
                                titleEn: "Be Holy",
                                titleHe: "קדושים תהיו",
                                description: "L'appel à la sainteté",
                                descriptionEn: "The call to holiness",
                                descriptionHe: "הקריאה לקדושה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-06-10"
                            }
                        ]
                    },
                    emor: {
                        name: "Emor",
                        nameEn: "Emor",
                        nameHe: "אמור",
                        audios: [
                            {
                                title: "Parle aux prêtres",
                                titleEn: "Speak to the Priests",
                                titleHe: "אמור אל הכהנים",
                                description: "Les lois spéciales pour les Cohanim",
                                descriptionEn: "Special laws for the Cohanim",
                                descriptionHe: "חוקים מיוחדים לכהנים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-06-15"
                            }
                        ]
                    },
                    behar: {
                        name: "Behar",
                        nameEn: "Behar",
                        nameHe: "בהר",
                        audios: [
                            {
                                title: "Sur la montagne",
                                titleEn: "On the Mountain",
                                titleHe: "בהר",
                                description: "Les lois de la Shemita et du Jubilé",
                                descriptionEn: "Laws of Shemita and Jubilee",
                                descriptionHe: "חוקי השמיטה והיובל",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-06-20"
                            }
                        ]
                    },
                    bechukotai: {
                        name: "Bechukotai",
                        nameEn: "Bechukotai",
                        nameHe: "בחקתי",
                        audios: [
                            {
                                title: "Si vous marchez dans mes lois",
                                titleEn: "If You Walk in My Statutes",
                                titleHe: "אם בחקתי תלכו",
                                description: "Bénédictions et malédictions",
                                descriptionEn: "Blessings and curses",
                                descriptionHe: "ברכות וקללות",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-06-25"
                            }
                        ]
                    }
                }
            },
            bamidbar: {
                name: "Bamidbar",
                nameEn: "Numbers",
                nameHe: "במדבר",
                parachiot: {
                    bamidbar: {
                        name: "Bamidbar",
                        nameEn: "Bamidbar",
                        nameHe: "במדבר",
                        audios: [
                            {
                                title: "Dans le désert",
                                titleEn: "In the Desert",
                                titleHe: "במדבר",
                                description: "Le recensement du peuple",
                                descriptionEn: "The census of the people",
                                descriptionHe: "מפקד העם",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-06-30"
                            }
                        ]
                    },
                    naso: {
                        name: "Naso",
                        nameEn: "Naso",
                        nameHe: "נשא",
                        audios: [
                            {
                                title: "Élève les têtes",
                                titleEn: "Lift the Heads",
                                titleHe: "נשא את ראש",
                                description: "La bénédiction sacerdotale",
                                descriptionEn: "The priestly blessing",
                                descriptionHe: "ברכת הכהנים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-07-05"
                            }
                        ]
                    },
                    behaalotcha: {
                        name: "Behaalotcha",
                        nameEn: "Behaalotcha",
                        nameHe: "בהעלתך",
                        audios: [
                            {
                                title: "Quand tu allumeras",
                                titleEn: "When You Light",
                                titleHe: "בהעלתך",
                                description: "L'allumage de la Menorah",
                                descriptionEn: "Lighting the Menorah",
                                descriptionHe: "הדלקת המנורה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-07-10"
                            }
                        ]
                    },
                    shelach: {
                        name: "Shelach",
                        nameEn: "Shelach",
                        nameHe: "שלח",
                        audios: [
                            {
                                title: "Envoie pour toi",
                                titleEn: "Send for Yourself",
                                titleHe: "שלח לך",
                                description: "L'histoire des explorateurs",
                                descriptionEn: "The story of the spies",
                                descriptionHe: "סיפור המרגלים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-07-15"
                            }
                        ]
                    },
                    korach: {
                        name: "Korach",
                        nameEn: "Korach",
                        nameHe: "קרח",
                        audios: [
                            {
                                title: "La révolte de Korach",
                                titleEn: "Korach's Rebellion",
                                titleHe: "מרד קרח",
                                description: "La contestation de l'autorité de Moïse",
                                descriptionEn: "Challenging Moses' authority",
                                descriptionHe: "ערעור על סמכותו של משה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-07-20"
                            }
                        ]
                    },
                    chukat: {
                        name: "Chukat",
                        nameEn: "Chukat",
                        nameHe: "חקת",
                        audios: [
                            {
                                title: "La loi de la vache rousse",
                                titleEn: "The Law of the Red Heifer",
                                titleHe: "חוק הפרה האדומה",
                                description: "Le mystère de la purification",
                                descriptionEn: "The mystery of purification",
                                descriptionHe: "תעלומת הטיהור",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-07-25"
                            }
                        ]
                    },
                    balak: {
                        name: "Balak",
                        nameEn: "Balak",
                        nameHe: "בלק",
                        audios: [
                            {
                                title: "Balaam et son ânesse",
                                titleEn: "Balaam and his Donkey",
                                titleHe: "בלעם ואתונו",
                                description: "L'histoire du prophète non-juif",
                                descriptionEn: "The story of the non-Jewish prophet",
                                descriptionHe: "סיפור הנביא הלא-יהודי",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-07-30"
                            }
                        ]
                    },
                    pinchas: {
                        name: "Pinchas",
                        nameEn: "Pinchas",
                        nameHe: "פינחס",
                        audios: [
                            {
                                title: "Le zèle de Pinchas",
                                titleEn: "Pinchas' Zeal",
                                titleHe: "קנאות פינחס",
                                description: "L'acte courageux de Pinchas",
                                descriptionEn: "Pinchas' courageous act",
                                descriptionHe: "המעשה האמיץ של פינחס",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-08-05"
                            }
                        ]
                    },
                    matot: {
                        name: "Matot",
                        nameEn: "Matot",
                        nameHe: "מטות",
                        audios: [
                            {
                                title: "Les tribus",
                                titleEn: "The Tribes",
                                titleHe: "המטות",
                                description: "Les lois des vœux",
                                descriptionEn: "Laws of vows",
                                descriptionHe: "חוקי הנדרים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-08-10"
                            }
                        ]
                    },
                    masei: {
                        name: "Masei",
                        nameEn: "Masei",
                        nameHe: "מסעי",
                        audios: [
                            {
                                title: "Les voyages",
                                titleEn: "The Journeys",
                                titleHe: "המסעות",
                                description: "Les étapes du désert",
                                descriptionEn: "The desert stages",
                                descriptionHe: "תחנות המדבר",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-08-15"
                            }
                        ]
                    }
                }
            },
            devarim: {
                name: "Devarim",
                nameEn: "Deuteronomy",
                nameHe: "דברים",
                parachiot: {
                    devarim: {
                        name: "Devarim",
                        nameEn: "Devarim",
                        nameHe: "דברים",
                        audios: [
                            {
                                title: "Les paroles de Moïse",
                                titleEn: "Moses' Words",
                                titleHe: "דברי משה",
                                description: "Le discours d'adieu de Moïse",
                                descriptionEn: "Moses' farewell speech",
                                descriptionHe: "נאום הפרידה של משה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-08-20"
                            }
                        ]
                    },
                    vaetchanan: {
                        name: "Vaetchanan",
                        nameEn: "Vaetchanan",
                        nameHe: "ואתחנן",
                        audios: [
                            {
                                title: "Et j'implorai",
                                titleEn: "And I Pleaded",
                                titleHe: "ואתחנן",
                                description: "Le Shema Israël",
                                descriptionEn: "The Shema Israel",
                                descriptionHe: "שמע ישראל",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-08-25"
                            }
                        ]
                    },
                    ekev: {
                        name: "Ekev",
                        nameEn: "Ekev",
                        nameHe: "עקב",
                        audios: [
                            {
                                title: "En conséquence",
                                titleEn: "As a Result",
                                titleHe: "עקב",
                                description: "Les récompenses de l'obéissance",
                                descriptionEn: "Rewards of obedience",
                                descriptionHe: "שכר הציות",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-08-30"
                            }
                        ]
                    },
                    reeh: {
                        name: "Re'eh",
                        nameEn: "Re'eh",
                        nameHe: "ראה",
                        audios: [
                            {
                                title: "Vois",
                                titleEn: "See",
                                titleHe: "ראה",
                                description: "Bénédiction et malédiction",
                                descriptionEn: "Blessing and curse",
                                descriptionHe: "ברכה וקללה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-05"
                            }
                        ]
                    },
                    shoftim: {
                        name: "Shoftim",
                        nameEn: "Shoftim",
                        nameHe: "שופטים",
                        audios: [
                            {
                                title: "Juges",
                                titleEn: "Judges",
                                titleHe: "שופטים",
                                description: "La justice et le gouvernement",
                                descriptionEn: "Justice and government",
                                descriptionHe: "צדק וממשל",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-10"
                            }
                        ]
                    },
                    ki_tetze: {
                        name: "Ki Tetze",
                        nameEn: "Ki Tetze",
                        nameHe: "כי תצא",
                        audios: [
                            {
                                title: "Quand tu sortiras",
                                titleEn: "When You Go Out",
                                titleHe: "כי תצא",
                                description: "Les lois de la guerre et de la paix",
                                descriptionEn: "Laws of war and peace",
                                descriptionHe: "חוקי מלחמה ושלום",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-15"
                            }
                        ]
                    },
                    ki_tavo: {
                        name: "Ki Tavo",
                        nameEn: "Ki Tavo",
                        nameHe: "כי תבא",
                        audios: [
                            {
                                title: "Quand tu viendras",
                                titleEn: "When You Come",
                                titleHe: "כי תבא",
                                description: "Les prémices et les malédictions",
                                descriptionEn: "First fruits and curses",
                                descriptionHe: "ביכורים וקללות",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-20"
                            }
                        ]
                    },
                    nitzavim: {
                        name: "Nitzavim",
                        nameEn: "Nitzavim",
                        nameHe: "נצבים",
                        audios: [
                            {
                                title: "Vous vous tenez",
                                titleEn: "You Stand",
                                titleHe: "אתם נצבים",
                                description: "L'alliance éternelle",
                                descriptionEn: "The eternal covenant",
                                descriptionHe: "הברית הנצחית",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-25"
                            }
                        ]
                    },
                    vayelech: {
                        name: "Vayelech",
                        nameEn: "Vayelech",
                        nameHe: "וילך",
                        audios: [
                            {
                                title: "Et il alla",
                                titleEn: "And He Went",
                                titleHe: "וילך",
                                description: "Les derniers conseils de Moïse",
                                descriptionEn: "Moses' final advice",
                                descriptionHe: "עצות האחרונות של משה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-30"
                            }
                        ]
                    },
                    haazinu: {
                        name: "Haazinu",
                        nameEn: "Haazinu",
                        nameHe: "האזינו",
                        audios: [
                            {
                                title: "Écoutez",
                                titleEn: "Listen",
                                titleHe: "האזינו",
                                description: "Le cantique de Moïse",
                                descriptionEn: "The Song of Moses",
                                descriptionHe: "שירת משה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-10-05"
                            }
                        ]
                    },
                    vezot_habracha: {
                        name: "Vezot Habracha",
                        nameEn: "Vezot Habracha",
                        nameHe: "וזאת הברכה",
                        audios: [
                            {
                                title: "Et voici la bénédiction",
                                titleEn: "And This is the Blessing",
                                titleHe: "וזאת הברכה",
                                description: "Les bénédictions finales de Moïse",
                                descriptionEn: "Moses' final blessings",
                                descriptionHe: "ברכות האחרונות של משה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-10-10"
                            }
                        ]
                    }
                }
            },
            fetes: {
                name: "Fêtes Juives",
                nameEn: "Jewish Holidays",
                nameHe: "חגים יהודיים",
                parachiot: {
                    rosh_hashana: {
                        name: "Rosh Hashana",
                        nameEn: "Rosh Hashana",
                        nameHe: "ראש השנה",
                        audios: [
                            {
                                title: "Le Nouvel An juif - Partie 1",
                                titleEn: "Jewish New Year - Part 1",
                                titleHe: "השנה החדשה היהודית - חלק א",
                                description: "La signification spirituelle de Rosh Hashana",
                                descriptionEn: "The spiritual meaning of Rosh Hashana",
                                descriptionHe: "המשמעות הרוחנית של ראש השנה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-01"
                            },
                            {
                                title: "Le son du Shofar",
                                titleEn: "The Sound of the Shofar",
                                titleHe: "קול השופר",
                                description: "Les différents sons et leur signification",
                                descriptionEn: "The different sounds and their meaning",
                                descriptionHe: "הקולות השונים ומשמעותם",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-02"
                            }
                        ]
                    },
                    yom_kippur: {
                        name: "Yom Kippur",
                        nameEn: "Yom Kippur",
                        nameHe: "יום כיפור",
                        audios: [
                            {
                                title: "Le Grand Pardon",
                                titleEn: "The Day of Atonement",
                                titleHe: "יום הכיפורים",
                                description: "La Teshuva et le pardon divin",
                                descriptionEn: "Teshuva and divine forgiveness",
                                descriptionHe: "תשובה וסליחה אלוהית",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-11"
                            },
                            {
                                title: "La prière de Kol Nidrei",
                                titleEn: "The Kol Nidrei Prayer",
                                titleHe: "תפילת כל נדרי",
                                description: "L'ouverture solennelle de Yom Kippur",
                                descriptionEn: "The solemn opening of Yom Kippur",
                                descriptionHe: "הפתיחה החגיגית של יום כיפור",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-12"
                            }
                        ]
                    },
                    sukkot: {
                        name: "Sukkot",
                        nameEn: "Sukkot",
                        nameHe: "סוכות",
                        audios: [
                            {
                                title: "La fête des Cabanes",
                                titleEn: "The Festival of Booths",
                                titleHe: "חג הסוכות",
                                description: "Construire la Soukka et sa signification",
                                descriptionEn: "Building the Sukkah and its meaning",
                                descriptionHe: "בניית הסוכה ומשמעותה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-18"
                            },
                            {
                                title: "Les Quatre Espèces",
                                titleEn: "The Four Species",
                                titleHe: "ארבעת המינים",
                                description: "Loulav, Etrog, Hadass et Arava",
                                descriptionEn: "Lulav, Etrog, Hadass and Arava",
                                descriptionHe: "לולב, אתרוג, הדס וערבה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-19"
                            }
                        ]
                    },
                    simchat_torah: {
                        name: "Simchat Torah",
                        nameEn: "Simchat Torah",
                        nameHe: "שמחת תורה",
                        audios: [
                            {
                                title: "La joie de la Torah",
                                titleEn: "The Joy of Torah",
                                titleHe: "שמחת התורה",
                                description: "Célébrer la fin et le commencement du cycle",
                                descriptionEn: "Celebrating the end and beginning of the cycle",
                                descriptionHe: "חגיגת הסיום והתחלה של המחזור",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-09-26"
                            }
                        ]
                    },
                    hanukkah: {
                        name: "Hanukkah",
                        nameEn: "Hanukkah",
                        nameHe: "חנוכה",
                        audios: [
                            {
                                title: "La fête des Lumières",
                                titleEn: "The Festival of Lights",
                                titleHe: "חג האורים",
                                description: "Le miracle de l'huile et des Maccabées",
                                descriptionEn: "The miracle of oil and the Maccabees",
                                descriptionHe: "נס השמן והמכבים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-12-01"
                            },
                            {
                                title: "Allumer la Hanukkiah",
                                titleEn: "Lighting the Hanukkiah",
                                titleHe: "הדלקת החנוכייה",
                                description: "Les lois et coutumes de l'allumage",
                                descriptionEn: "Laws and customs of lighting",
                                descriptionHe: "הלכות ומנהגי ההדלקה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-12-02"
                            }
                        ]
                    },
                    tu_bishvat: {
                        name: "Tu BiShvat",
                        nameEn: "Tu BiShvat",
                        nameHe: "ט״ו בשבט",
                        audios: [
                            {
                                title: "Le Nouvel An des arbres",
                                titleEn: "New Year of the Trees",
                                titleHe: "ראש השנה לאילנות",
                                description: "La connexion spirituelle avec la nature",
                                descriptionEn: "Spiritual connection with nature",
                                descriptionHe: "הקשר הרוחני עם הטבע",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-01-25"
                            }
                        ]
                    },
                    purim: {
                        name: "Purim",
                        nameEn: "Purim",
                        nameHe: "פורים",
                        audios: [
                            {
                                title: "L'histoire d'Esther",
                                titleEn: "The Story of Esther",
                                titleHe: "סיפור אסתר",
                                description: "La Meguilat Esther et ses enseignements",
                                descriptionEn: "Megillat Esther and its teachings",
                                descriptionHe: "מגילת אסתר ולקחיה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-14"
                            },
                            {
                                title: "Les mitzvot de Purim",
                                titleEn: "The Mitzvot of Purim",
                                titleHe: "מצוות פורים",
                                description: "Lecture de la Meguilah, Michloach Manot et Matanot Laevyonim",
                                descriptionEn: "Reading the Megillah, Mishloach Manot and Matanot Laevyonim",
                                descriptionHe: "קריאת המגילה, משלוח מנות ומתנות לאביונים",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-03-15"
                            }
                        ]
                    },
                    pesach: {
                        name: "Pessah",
                        nameEn: "Passover",
                        nameHe: "פסח",
                        audios: [
                            {
                                title: "La sortie d'Égypte",
                                titleEn: "The Exodus from Egypt",
                                titleHe: "יציאת מצרים",
                                description: "L'histoire de la libération",
                                descriptionEn: "The story of liberation",
                                descriptionHe: "סיפור השחרור",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-22"
                            },
                            {
                                title: "Le Seder de Pessah",
                                titleEn: "The Passover Seder",
                                titleHe: "סדר פסח",
                                description: "Les 15 étapes du Seder et la Haggada",
                                descriptionEn: "The 15 steps of the Seder and the Haggadah",
                                descriptionHe: "15 שלבי הסדר וההגדה",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-23"
                            },
                            {
                                title: "Les lois du Hametz",
                                titleEn: "Laws of Chametz",
                                titleHe: "הלכות חמץ",
                                description: "Nettoyer et vendre le Hametz",
                                descriptionEn: "Cleaning and selling Chametz",
                                descriptionHe: "ניקוי ומכירת חמץ",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-04-20"
                            }
                        ]
                    },
                    lag_baomer: {
                        name: "Lag BaOmer",
                        nameEn: "Lag BaOmer",
                        nameHe: "ל״ג בעומר",
                        audios: [
                            {
                                title: "Rabbi Shimon Bar Yochai",
                                titleEn: "Rabbi Shimon Bar Yochai",
                                titleHe: "רבי שמעון בר יוחאי",
                                description: "L'auteur du Zohar et Lag BaOmer",
                                descriptionEn: "The author of the Zohar and Lag BaOmer",
                                descriptionHe: "מחבר הזוהר ול״ג בעומר",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-05-26"
                            }
                        ]
                    },
                    shavuot: {
                        name: "Shavuot",
                        nameEn: "Shavuot",
                        nameHe: "שבועות",
                        audios: [
                            {
                                title: "Le don de la Torah",
                                titleEn: "The Giving of the Torah",
                                titleHe: "מתן תורה",
                                description: "La révélation au mont Sinaï",
                                descriptionEn: "The revelation at Mount Sinai",
                                descriptionHe: "ההתגלות בהר סיני",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-06-12"
                            },
                            {
                                title: "La fête des prémices",
                                titleEn: "Festival of First Fruits",
                                titleHe: "חג הביכורים",
                                description: "Apporter les premiers fruits au Temple",
                                descriptionEn: "Bringing first fruits to the Temple",
                                descriptionHe: "הבאת בכורים למקדש",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-06-13"
                            }
                        ]
                    },
                    tisha_bav: {
                        name: "Tisha B'Av",
                        nameEn: "Tisha B'Av",
                        nameHe: "תשעה באב",
                        audios: [
                            {
                                title: "La destruction du Temple",
                                titleEn: "The Destruction of the Temple",
                                titleHe: "חורבן בית המקדש",
                                description: "Le deuil national et l'espoir de reconstruction",
                                descriptionEn: "National mourning and hope for rebuilding",
                                descriptionHe: "אבל לאומי ותקווה לבנייה מחדש",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-08-13"
                            }
                        ]
                    },
                    tu_beav: {
                        name: "Tu BeAv",
                        nameEn: "Tu BeAv",
                        nameHe: "ט״ו באב",
                        audios: [
                            {
                                title: "La fête de l'amour",
                                titleEn: "Festival of Love",
                                titleHe: "חג האהבה",
                                description: "La joie après la destruction",
                                descriptionEn: "Joy after destruction",
                                descriptionHe: "שמחה אחרי חורבן",
                                youtubeId: "RkJtG9unkN4",
                                date: "2024-08-19"
                            }
                        ]
                    }
                }
            }
        };

        // Translation object
        const translations = {
            fr: {
                "nav-home": "Accueil",
                "nav-about": "À propos",
                "hero-title": "Enseignements Audio",
                "hero-description": "Découvrez plus de 200 enseignements audio organisés par paracha et sefer",
                "search-placeholder": "Rechercher dans les enseignements...",
                "filter-all-sefer": "Tous les Sefarim",
                "sort-title": "Trier par titre",
                "sort-date": "Trier par date",
                "audio-count": "enseignements"
            },
            en: {
                "nav-home": "Home",
                "nav-about": "About",
                "hero-title": "Audio Teachings",
                "hero-description": "Discover over 200 audio teachings organized by paracha and sefer",
                "search-placeholder": "Search in teachings...",
                "filter-all-sefer": "All Sefarim",
                "sort-title": "Sort by title",
                "sort-date": "Sort by date",
                "audio-count": "teachings"
            },
            he: {
                "nav-home": "בית",
                "nav-about": "אודות",
                "hero-title": "שיעורי אודיו",
                "hero-description": "גלו יותר מ-200 שיעורי אודיו מסודרים לפי פרשה וספר",
                "search-placeholder": "חיפוש בשיעורים...",
                "filter-all-sefer": "כל הספרים",
                "sort-title": "מיון לפי כותרת",
                "sort-date": "מיון לפי תאריך",
                "audio-count": "שיעורים"
            }
        };

        let currentLang = 'fr';
        let currentView = 'sefarim';

        // Initialize the application
        function init() {
            renderSeferGrid();
            setupEventListeners();
            updateLanguage();
        }

        // Render the sefer grid
        function renderSeferGrid() {
            const grid = document.getElementById('seferGrid');
            grid.innerHTML = '';

            Object.keys(audioData).forEach(seferKey => {
                const sefer = audioData[seferKey];
                const totalAudios = Object.values(sefer.parachiot)
                    .reduce((total, paracha) => total + paracha.audios.length, 0);

                const card = document.createElement('div');
                card.className = 'sefer-card fade-in';
                card.innerHTML = `
                    <h3>${getTranslatedProperty(sefer, 'name')}</h3>
                    <p>Explorez les enseignements de ce sefer</p>
                    <span class="audio-count">${totalAudios} ${translations[currentLang]['audio-count']}</span>
                `;
                card.addEventListener('click', () => showSeferContent(seferKey));
                grid.appendChild(card);
            });
        }

        // Show content for a specific sefer
        function showSeferContent(seferKey) {
            const sefer = audioData[seferKey];
            const parachaList = document.getElementById('parachaList');
            const seferGrid = document.getElementById('seferGrid');

            currentView = 'paracha';
            seferGrid.style.display = 'none';
            parachaList.className = 'paracha-list active';
            parachaList.innerHTML = '';

            // Update sefer filter to show current sefer
            document.getElementById('seferFilter').value = seferKey;

            Object.keys(sefer.parachiot).forEach(parachaKey => {
                const paracha = sefer.parachiot[parachaKey];
                const parachaDiv = document.createElement('div');
                parachaDiv.className = 'paracha-item';
                
                parachaDiv.innerHTML = `
                    <div class="paracha-header" onclick="toggleParacha('${parachaKey}')">
                        <h3>${getTranslatedProperty(paracha, 'name')}</h3>
                        <span>${paracha.audios.length} ${translations[currentLang]['audio-count']}</span>
                    </div>
                    <div class="paracha-content" id="paracha-${parachaKey}">
                        ${paracha.audios.map(audio => `
                            <div class="audio-item">
                                <div class="audio-title">${getTranslatedProperty(audio, 'title')}</div>
                                <div class="audio-description">${getTranslatedProperty(audio, 'description')}</div>
                                <iframe class="audio-player" 
                                    src="https://www.youtube.com/embed/${audio.youtubeId}" 
                                    title="${getTranslatedProperty(audio, 'title')}"
                                    frameborder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                    allowfullscreen>
                                </iframe>
                            </div>
                        `).join('')}
                    </div>
                `;
                parachaList.appendChild(parachaDiv);
            });

            // Add back button
            const backButton = document.createElement('button');
            backButton.textContent = currentLang === 'fr' ? '← Retour aux Sefarim' : 
                                   currentLang === 'en' ? '← Back to Sefarim' : 
                                   '← חזרה לספרים';
            backButton.style.cssText = `
                margin-bottom: 2rem;
                padding: 1rem 2rem;
                background: var(--secondary-color);
                color: white;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 1rem;
            `;
            backButton.addEventListener('click', showSeferGrid);
            parachaList.insertBefore(backButton, parachaList.firstChild);
        }

        // Show sefer grid
        function showSeferGrid() {
            currentView = 'sefarim';
            document.getElementById('seferGrid').style.display = 'grid';
            document.getElementById('parachaList').className = 'paracha-list';
            
            // Reset filters
            document.getElementById('seferFilter').value = '';
            
            // Show all cards
            document.querySelectorAll('.sefer-card').forEach(card => {
                card.style.display = 'block';
            });
        }

        // Toggle paracha content
        function toggleParacha(parachaKey) {
            const content = document.getElementById(`paracha-${parachaKey}`);
            content.classList.toggle('active');
        }

        // Get translated property based on current language
        function getTranslatedProperty(obj, prop) {
            const langSuffix = currentLang === 'fr' ? '' : currentLang.charAt(0).toUpperCase() + currentLang.slice(1);
            return obj[prop + langSuffix] || obj[prop];
        }

        // Setup event listeners
        function setupEventListeners() {
            // Mobile menu toggle
            document.getElementById('mobileMenuToggle').addEventListener('click', () => {
                document.getElementById('navLinks').classList.toggle('active');
            });

            // Language switcher
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentLang = btn.dataset.lang;
                    updateLanguage();
                    renderSeferGrid();
                });
            });

            // Search functionality
            document.getElementById('searchInput').addEventListener('input', handleSearch);
            
            // Filter functionality
            document.getElementById('seferFilter').addEventListener('change', (e) => {
                handleSeferFilter(e.target.value);
            });
            
            document.getElementById('sortFilter').addEventListener('change', (e) => {
                handleSortFilter(e.target.value);
            });
        }

        // Update language
        function updateLanguage() {
            document.querySelectorAll('[data-lang]').forEach(element => {
                const key = element.getAttribute('data-lang');
                if (translations[currentLang] && translations[currentLang][key]) {
                    element.textContent = translations[currentLang][key];
                }
            });

            document.querySelectorAll('[data-lang-placeholder]').forEach(element => {
                const key = element.getAttribute('data-lang-placeholder');
                if (translations[currentLang] && translations[currentLang][key]) {
                    element.placeholder = translations[currentLang][key];
                }
            });

            // Update body direction for Hebrew
            document.body.className = currentLang === 'he' ? 'hebrew' : '';
        }

        // Handle search
        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase().trim();
            
            if (searchTerm === '') {
                // Reset to current view if search is empty
                if (currentView === 'sefarim') {
                    showSeferGrid();
                }
                return;
            }

            // Always perform global search regardless of current view
            performGlobalSearch(searchTerm);
        }

        // Perform global search across all content
        function performGlobalSearch(searchTerm) {
            const results = performAdvancedSearch(searchTerm);
            
            if (results.length === 0) {
                showNoResults(searchTerm);
                return;
            }

            // Group results by sefer for better display
            const groupedResults = groupResultsBySefer(results);
            displaySearchResults(groupedResults, searchTerm);
        }

        // Group search results by sefer
        function groupResultsBySefer(results) {
            const grouped = {};
            
            results.forEach(result => {
                if (!grouped[result.seferKey]) {
                    grouped[result.seferKey] = {
                        sefer: result.sefer,
                        seferKey: result.seferKey,
                        parachiot: {}
                    };
                }
                
                if (!grouped[result.seferKey].parachiot[result.parachaKey]) {
                    grouped[result.seferKey].parachiot[result.parachaKey] = {
                        paracha: result.paracha,
                        parachaKey: result.parachaKey,
                        audios: []
                    };
                }
                
                grouped[result.seferKey].parachiot[result.parachaKey].audios.push({
                    audio: result.audio,
                    audioIndex: result.audioIndex,
                    relevance: result.relevance
                });
            });
            
            return grouped;
        }

        // Display search results
        function displaySearchResults(groupedResults, searchTerm) {
            const parachaList = document.getElementById('parachaList');
            const seferGrid = document.getElementById('seferGrid');
            
            currentView = 'search';
            seferGrid.style.display = 'none';
            parachaList.className = 'paracha-list active';
            parachaList.innerHTML = '';

            // Add search header
            const searchHeader = document.createElement('div');
            searchHeader.style.cssText = `
                background: white;
                padding: 1.5rem;
                border-radius: 10px;
                box-shadow: var(--shadow);
                margin-bottom: 2rem;
                text-align: center;
            `;
            
            const totalResults = Object.values(groupedResults).reduce((total, seferResult) => {
                return total + Object.values(seferResult.parachiot).reduce((seferTotal, parachaResult) => {
                    return seferTotal + parachaResult.audios.length;
                }, 0);
            }, 0);
            
            searchHeader.innerHTML = `
                <h2 style="color: var(--primary-color); margin-bottom: 0.5rem;">
                    ${currentLang === 'fr' ? 'Résultats de recherche' : 
                      currentLang === 'en' ? 'Search Results' : 
                      'תוצאות חיפוש'}
                </h2>
                <p style="color: var(--text-light);">
                    ${totalResults} ${currentLang === 'fr' ? 'résultats trouvés pour' : 
                                     currentLang === 'en' ? 'results found for' : 
                                     'תוצאות נמצאו עבור'} "<strong>${searchTerm}</strong>"
                </p>
            `;

            // Add back button
            const backButton = document.createElement('button');
            backButton.textContent = currentLang === 'fr' ? '← Retour aux Sefarim' : 
                                   currentLang === 'en' ? '← Back to Sefarim' : 
                                   '← חזרה לספרים';
            backButton.style.cssText = `
                margin-bottom: 1rem;
                padding: 1rem 2rem;
                background: var(--secondary-color);
                color: white;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 1rem;
            `;
            backButton.addEventListener('click', () => {
                document.getElementById('searchInput').value = '';
                showSeferGrid();
            });

            parachaList.appendChild(backButton);
            parachaList.appendChild(searchHeader);

            // Display results grouped by sefer
            Object.values(groupedResults).forEach(seferResult => {
                const seferSection = document.createElement('div');
                seferSection.style.cssText = `
                    background: white;
                    border-radius: 10px;
                    box-shadow: var(--shadow);
                    margin-bottom: 2rem;
                    overflow: hidden;
                `;

                const seferHeader = document.createElement('div');
                seferHeader.style.cssText = `
                    background: var(--primary-color);
                    color: white;
                    padding: 1rem 1.5rem;
                    font-size: 1.2rem;
                    font-weight: bold;
                `;
                seferHeader.textContent = getTranslatedProperty(seferResult.sefer, 'name');
                seferSection.appendChild(seferHeader);

                Object.values(seferResult.parachiot).forEach(parachaResult => {
                    const parachaDiv = document.createElement('div');
                    parachaDiv.className = 'paracha-item';
                    parachaDiv.style.marginBottom = '0';
                    
                    parachaDiv.innerHTML = `
                        <div class="paracha-header" onclick="toggleParacha('search-${seferResult.seferKey}-${parachaResult.parachaKey}')" style="border-left: 4px solid var(--accent-color);">
                            <h3>${getTranslatedProperty(parachaResult.paracha, 'name')}</h3>
                            <span>${parachaResult.audios.length} ${translations[currentLang]['audio-count']}</span>
                        </div>
                        <div class="paracha-content" id="paracha-search-${seferResult.seferKey}-${parachaResult.parachaKey}">
                            ${parachaResult.audios.map(audioResult => `
                                <div class="audio-item" style="border-left: 3px solid var(--accent-color);">
                                    <div class="audio-title">${highlightSearchTerm(getTranslatedProperty(audioResult.audio, 'title'), searchTerm)}</div>
                                    <div class="audio-description">${highlightSearchTerm(getTranslatedProperty(audioResult.audio, 'description'), searchTerm)}</div>
                                    <iframe class="audio-player" 
                                        src="https://www.youtube.com/embed/${audioResult.audio.youtubeId}" 
                                        title="${getTranslatedProperty(audioResult.audio, 'title')}"
                                        frameborder="0" 
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                        allowfullscreen>
                                    </iframe>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    seferSection.appendChild(parachaDiv);
                });

                parachaList.appendChild(seferSection);
            });
        }

        // Highlight search terms in results
        function highlightSearchTerm(text, searchTerm) {
            if (!searchTerm) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark style="background-color: #fff3cd; padding: 2px 4px; border-radius: 3px;">$1</mark>');
        }

        // Show no results message
        function showNoResults(searchTerm) {
            const parachaList = document.getElementById('parachaList');
            const seferGrid = document.getElementById('seferGrid');
            
            currentView = 'search';
            seferGrid.style.display = 'none';
            parachaList.className = 'paracha-list active';
            parachaList.innerHTML = '';

            const noResultsDiv = document.createElement('div');
            noResultsDiv.style.cssText = `
                background: white;
                padding: 3rem;
                border-radius: 10px;
                box-shadow: var(--shadow);
                text-align: center;
                margin-bottom: 2rem;
            `;
            
            noResultsDiv.innerHTML = `
                <h2 style="color: var(--text-light); margin-bottom: 1rem;">
                    ${currentLang === 'fr' ? 'Aucun résultat trouvé' : 
                      currentLang === 'en' ? 'No results found' : 
                      'אין תוצאות'}
                </h2>
                <p style="color: var(--text-light);">
                    ${currentLang === 'fr' ? 'Aucun enseignement trouvé pour' : 
                      currentLang === 'en' ? 'No teachings found for' : 
                      'לא נמצאו שיעורים עבור'} "<strong>${searchTerm}</strong>"
                </p>
                <p style="color: var(--text-light); margin-top: 1rem; font-size: 0.9rem;">
                    ${currentLang === 'fr' ? 'Essayez avec des mots-clés différents ou plus généraux' : 
                      currentLang === 'en' ? 'Try different or more general keywords' : 
                      'נסו מילות מפתח שונות או כלליות יותר'}
                </p>
            `;

            // Add back button
            const backButton = document.createElement('button');
            backButton.textContent = currentLang === 'fr' ? '← Retour aux Sefarim' : 
                                   currentLang === 'en' ? '← Back to Sefarim' : 
                                   '← חזרה לספרים';
            backButton.style.cssText = `
                margin-bottom: 2rem;
                padding: 1rem 2rem;
                background: var(--secondary-color);
                color: white;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 1rem;
            `;
            backButton.addEventListener('click', () => {
                document.getElementById('searchInput').value = '';
                showSeferGrid();
            });

            parachaList.appendChild(backButton);
            parachaList.appendChild(noResultsDiv);
        }

        // Handle sefer filter
        function handleSeferFilter(selectedSefer) {
            if (selectedSefer === '') {
                // Show all sefarim
                document.querySelectorAll('.sefer-card').forEach(card => {
                    card.style.display = 'block';
                });
            } else {
                // Show only selected sefer or navigate to it
                if (currentView === 'sefarim') {
                    document.querySelectorAll('.sefer-card').forEach(card => {
                        const seferKey = getSeferKeyFromCard(card);
                        card.style.display = seferKey === selectedSefer ? 'block' : 'none';
                    });
                } else {
                    // If we're in paracha view, navigate to the selected sefer
                    showSeferContent(selectedSefer);
                }
            }
        }

        // Get sefer key from card element
        function getSeferKeyFromCard(card) {
            const seferName = card.querySelector('h3').textContent;
            for (const [key, sefer] of Object.entries(audioData)) {
                if (getTranslatedProperty(sefer, 'name') === seferName) {
                    return key;
                }
            }
            return null;
        }

        // Handle sort filter
        function handleSortFilter(sortBy) {
            if (currentView === 'sefarim') {
                sortSeferCards(sortBy);
            } else if (currentView === 'paracha') {
                sortParachaContent(sortBy);
            }
            // Search results don't need sorting as they're already sorted by relevance
        }

        // Sort sefer cards
        function sortSeferCards(sortBy) {
            const grid = document.getElementById('seferGrid');
            const cards = Array.from(grid.querySelectorAll('.sefer-card'));
            
            cards.sort((a, b) => {
                const nameA = a.querySelector('h3').textContent;
                const nameB = b.querySelector('h3').textContent;
                
                if (sortBy === 'title') {
                    return nameA.localeCompare(nameB);
                } else if (sortBy === 'date') {
                    // For sefarim, we'll sort by order in Torah
                    const orderA = getSeferOrder(nameA);
                    const orderB = getSeferOrder(nameB);
                    return orderA - orderB;
                }
                return 0;
            });
            
            // Re-append sorted cards
            cards.forEach(card => grid.appendChild(card));
        }

        // Get sefer order for sorting
        function getSeferOrder(seferName) {
            const order = {
                'Beréchit': 1, 'Genesis': 1, 'בראשית': 1,
                'Chemot': 2, 'Exodus': 2, 'שמות': 2,
                'Vayikra': 3, 'Leviticus': 3, 'ויקרא': 3,
                'Bamidbar': 4, 'Numbers': 4, 'במדבר': 4,
                'Devarim': 5, 'Deuteronomy': 5, 'דברים': 5,
                'Fêtes Juives': 6, 'Jewish Holidays': 6, 'חגים יהודיים': 6
            };
            return order[seferName] || 999;
        }

        // Sort paracha content
        function sortParachaContent(sortBy) {
            const parachaList = document.getElementById('parachaList');
            const items = Array.from(parachaList.querySelectorAll('.paracha-item'));
            
            items.forEach(item => {
                const audioItems = Array.from(item.querySelectorAll('.audio-item'));
                
                audioItems.sort((a, b) => {
                    if (sortBy === 'title') {
                        const titleA = a.querySelector('.audio-title').textContent.replace(/<[^>]*>/g, ''); // Remove HTML tags
                        const titleB = b.querySelector('.audio-title').textContent.replace(/<[^>]*>/g, '');
                        return titleA.localeCompare(titleB);
                    } else if (sortBy === 'date') {
                        // Extract dates from audio items and sort chronologically
                        const dateA = extractDateFromAudio(a);
                        const dateB = extractDateFromAudio(b);
                        return new Date(dateA) - new Date(dateB);
                    }
                    return 0;
                });
                
                // Re-append sorted audio items
                const parachaContent = item.querySelector('.paracha-content');
                audioItems.forEach(audioItem => parachaContent.appendChild(audioItem));
            });
        }

        // Extract date from audio item (look up in data)
        function extractDateFromAudio(audioElement) {
            const title = audioElement.querySelector('.audio-title').textContent.replace(/<[^>]*>/g, '');
            
            // Find the audio in our data structure
            for (const [seferKey, sefer] of Object.entries(audioData)) {
                for (const [parachaKey, paracha] of Object.entries(sefer.parachiot)) {
                    for (const audio of paracha.audios) {
                        const audioTitle = getTranslatedProperty(audio, 'title');
                        if (audioTitle === title) {
                            return audio.date || '2024-01-01'; // Default date if not found
                        }
                    }
                }
            }
            return '2024-01-01'; // Default fallback date
        }

        // Advanced search function
        function performAdvancedSearch(searchTerm) {
            const results = [];
            const term = searchTerm.toLowerCase();
            
            Object.entries(audioData).forEach(([seferKey, sefer]) => {
                Object.entries(sefer.parachiot).forEach(([parachaKey, paracha]) => {
                    paracha.audios.forEach((audio, index) => {
                        const title = getTranslatedProperty(audio, 'title').toLowerCase();
                        const description = getTranslatedProperty(audio, 'description').toLowerCase();
                        const parachaName = getTranslatedProperty(paracha, 'name').toLowerCase();
                        const seferName = getTranslatedProperty(sefer, 'name').toLowerCase();
                        
                        if (title.includes(term) || description.includes(term) || 
                            parachaName.includes(term) || seferName.includes(term)) {
                            results.push({
                                seferKey,
                                parachaKey,
                                audioIndex: index,
                                audio,
                                paracha,
                                sefer,
                                relevance: calculateRelevance(term, title, description, parachaName, seferName)
                            });
                        }
                    });
                });
            });
            
            // Sort by relevance
            results.sort((a, b) => b.relevance - a.relevance);
            return results;
        }

        // Calculate search relevance score
        function calculateRelevance(term, title, description, parachaName, seferName) {
            let score = 0;
            if (title.includes(term)) score += 10;
            if (description.includes(term)) score += 5;
            if (parachaName.includes(term)) score += 3;
            if (seferName.includes(term)) score += 1;
            
            // Boost exact matches
            if (title === term) score += 20;
            if (parachaName === term) score += 15;
            
            return score;
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);

        // Make toggleParacha available globally
        window.toggleParacha = toggleParacha;